CPU | 地址总线宽度 | 寻址能力 | 数据总线宽度 | 一次传输数据 
--- | --- | --- | --- |---
8080 | 16 | 64KB | 8 | 1B
8088 | 20 | 1MB | 8 | 1B
8086 | 20 | 1MB | 16 | 2B
80286 | 24 | 16MB | 16 | 2B
80386 | 32 | 4GB | 32 | 4B

机器语言/机器指令

汇编语言/汇编指令

汇编指令是机器指令的助记符

学习以8086为背景

字长即cpu位数

14种寄存器:
AX    --->   AH + AL   (兼容8位cpu)

命令 | 操作 
--- | ---
mov | 赋值
add | 累加
mov/add dest,source

段地址 * 16 + 偏移地址 = 物理地址

一段的起始地址 一定是 16的倍数;
一段的最大长度 为 64k

4个段寄存器
CS 代码段寄存器
DS 数据段寄存器
SS 栈段寄存器
ES 附加段寄存器

debug
-r 查看/改变寄存器内容
-d 列出 cs:ip 内存处的128个字节的内容
-e 改变内存中的内容
-u 将机器码翻译为汇编指令
-a 直接输入汇编指令
-t 执行 cs:ip 处的指令
-q 退出debug
-p process  
-g go 从指定位置开始执行,直到断点或程序结束


ip 指令指针寄存器

跳转指令    jmp
cs和ip不能使用mov 更改立即数,会报错

cs可以使用mov cs , ax 
ip 不行
 
### 内存中字的存储:
 低位存在低地址单元
 

### 从内存单元读取数据
数据段寄存器ds (data segment)

[address]  默认段地址为 ds 里的值

必须通过通用寄存器给段寄存器赋值

段寄存器不能参与add;
add两个加数不能同时为内存单元

### 栈
push 入栈
pop 出栈

ss 栈段寄存器
sp 栈顶指针寄存器  (变化的),指向存储单元的下一个位置

dw 0,0,...,0,0   栈需要的内存空间,在程序中通过定义"空"数据来取得.

### 程序与编译
```
assume cs:codesg  将寄存器与段关联,用逗号分隔
codesg segment    段定义

汇编指令

codesg ends       段结束
end               结束标记
```
开头和结尾属于伪指令;
没有对应的机器码的指令,最终不被CPU执行;
伪指令由编译器执行,编译器根据伪指令来进行编译

.asm  ----->   .obj  ------->.exe
         编译                连接

masm x.asm;       添加分号简化后续步骤
编译时两个中间文件
.lst   列表文件
.crf   交叉引用文件

link

一共256字节(100H) 的程序段前缀(PSP),作为数据区
即: CS = DS +10H

### CX  计数寄存器
双重循环里 如何使用 cx
1. 使用 dx 临时保存外层循环的cx (缺点,寄存器可能被占用)
2. 使用 固定内存空间 保存    (不安全)
3. 栈 保存        ( 优点 , n 层循环都可以使用)

s: 标号
loop s

数据不能以字母开头,需要加 0

段前缀  
内存单元[]中是数字时,需要在前面加上 段地址:

 es : 附加段寄存器    (避免一个ds反复赋值)

dw : define word 定义一个字
db :             byte                字节
dd :            double word   两个字

start: 标号 ,指示代码开始的位置
... 
end start

### 字符串
db 'asfdas'
`大小写夹杂统一转换为大写   使用 and 1101,1111`
`大小写夹杂统一转换为小写   使用 or  0010,0000`

[bx +_idata_] 为高级语言的数组提供了实现机制.
写法:
1. [bx+200]
2. [200+bx]
3. 200[bx]
4. [bx].200

### 变址寄存器
SI      source index  源变址寄存器
DI     destination index 目标变址寄存器
相对的,BX  常作为基址寄存器使用

只有bx,bp,si,di 可以用在[]里

bx 默认使用ds段; bp 默认使用 ss段
 
指令要处理的数据有多长?                  ```使用word ptr 或者 byte ptr 指明


### 标志寄存器
位置 | 缩写 | 意义 | 取值0 | 取值1
--- | --- | --- | --- | ---
11 | OF | overflow | NV | OV
10 | DF | direction | UP | DN
7 | SF | SIGN | PL | NG
6 | ZF | ZERO | NZ | ZR
2 | PF | PARITY | PO | PE
0 | CF | CARRY | NC | CY

奇偶指的二进制中的 1 的个数的奇偶
CF 为 无符号数运算时;
OF 为 有符号数运算时.

adc 带进位加法指令
sbb 带借位减法指令









